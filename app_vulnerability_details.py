import requests

base_URL = "https://services.nvd.nist.gov/rest/json/cves/2.0"

CPE_name = "Mozilla Firefox"

PARAMS = {"keywordSearch": CPE_name, "keywordExactMatch": ""}

req = requests.get(url=base_URL, params=PARAMS)

file = open(f"{CPE_name}_vulnerabilities.txt", "a+")

file.write(f"{CPE_name} \n\n\n")

for vulnerability in req.json()["vulnerabilities"]:
    file.write(f'cve ID: {vulnerability["cve"]["id"]}\n')
    file.write(f'Vulnerability Description: {vulnerability["cve"]["descriptions"][0]["value"]}\n')
    file.write(f'baseScore: {req.json()["vulnerabilities"][0]["cve"]["metrics"]["cvssMetricV2"][0]["cvssData"]["baseScore"]}\n')
    file.write(f'baseSeverity: {req.json()["vulnerabilities"][0]["cve"]["metrics"]["cvssMetricV2"][0]["baseSeverity"]}\n')
    file.write(f'exploitabilityScore: {req.json()["vulnerabilities"][0]["cve"]["metrics"]["cvssMetricV2"][0]["exploitabilityScore"]}\n')
    file.write(f'impactScore: {req.json()["vulnerabilities"][0]["cve"]["metrics"]["cvssMetricV2"][0]["impactScore"]}\n\n\n')
file.close()

